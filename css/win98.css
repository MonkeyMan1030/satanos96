:root{
  --teal:#008080;
  --silver:#c0c0c0;
  --navy:#000080;
  --gray:#808080;
  --black:#000000;
  --white:#ffffff;
}

html,body{height:100%;margin:0;overflow:hidden;}
body{
  background:var(--teal);
  font-family:Tahoma, Verdana, sans-serif;
  user-select:none;
}

/* Win98 bevel primitives */
.bevel-out{
  background:var(--silver);
  border-top:2px solid var(--white);
  border-left:2px solid var(--white);
  border-right:2px solid var(--black);
  border-bottom:2px solid var(--black);
}
.bevel-in{
  background:#fff;
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
}
.bevel-in-silver{
  background:var(--silver);
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
}
.btn98{
  padding:2px 8px;
  background:var(--silver);
  border-top:2px solid var(--white);
  border-left:2px solid var(--white);
  border-right:2px solid var(--black);
  border-bottom:2px solid var(--black);
  font-size:12px;
  cursor:pointer;
}
.btn98:active{
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
  padding:3px 7px 1px 9px;
}
.tinybtn{
  width:18px;height:16px;display:inline-flex;align-items:center;justify-content:center;
  font-size:11px;line-height:1;
  margin-left:2px;
}

/* Desktop */
#desktop{
  position:relative;
  width:100%;
  height:calc(100% - 38px);
  padding:10px;
  box-sizing:border-box;
}

.icon{
  width:90px;
  text-align:center;
  color:#fff;
  font-size:12px;
  margin:6px;
  display:inline-block;
  cursor:default;
}
.icon .ico{
  width:40px;height:40px;margin:0 auto 6px auto;
  background:var(--silver);
  border-top:2px solid var(--white);
  border-left:2px solid var(--white);
  border-right:2px solid var(--black);
  border-bottom:2px solid var(--black);
  display:flex;align-items:center;justify-content:center;
}
.icon.selected{
  outline:1px dotted #fff;
  outline-offset:2px;
}

/* Pixel-art scaling (crisp) */
.icoimg{
  width:32px;
  height:32px;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}

.titlebar .mini-ico img{
  width:14px;
  height:14px;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
  display:block;
}

/* Windows */
.window{
  position:absolute;
  width:520px;
  height:360px;
  min-width:260px;
  min-height:160px;
  display:none;
}
.titlebar{
  height:24px;
  background:linear-gradient(to right, #0000a8, #4c8cff);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 4px 0 6px;
  box-sizing:border-box;
  cursor:move;
  font-size:12px;
  font-weight:bold;
}
.titlebar .title{
  display:flex;gap:6px;align-items:center;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.titlebar .title .mini-ico{
  width:14px;height:14px;
  background:var(--silver);
  border:1px solid #000;
  display:flex;align-items:center;justify-content:center;
  overflow:hidden;
}
.win-controls{display:flex;align-items:center;}
.win-body{
  height:calc(100% - 24px);
  background:var(--silver);
  box-sizing:border-box;
  padding:6px;
  overflow:hidden;
}

/* Taskbar */
#taskbar{
  position:absolute;left:0;right:0;bottom:0;
  height:38px;
  background:var(--silver);
  border-top:2px solid var(--white);
  display:flex;align-items:center;
  padding:4px;
  box-sizing:border-box;
  gap:6px;
}
#startBtn{
  display:flex;align-items:center;gap:6px;
  font-weight:bold;
  height:28px;
}
#startBadge{
  width:16px;height:16px;
  background:var(--navy);
  color:#fff;
  display:flex;align-items:center;justify-content:center;
  font-size:10px;
  border:1px solid #000;
}
#tasks{
  flex:1;
  display:flex;
  gap:4px;
  overflow:auto;
  padding-bottom:2px;
}
.taskbtn{
  min-width:120px;
  max-width:240px;
  height:28px;
  display:flex;align-items:center;gap:6px;
  padding:0 8px;
  font-size:12px;
  cursor:pointer;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.taskbtn.active{
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
  padding-left:9px;
}
#tray{
  display:flex;align-items:center;gap:6px;
}
#clock, #status{
  height:28px;
  display:flex;align-items:center;
  padding:0 8px;
  font-size:12px;
  background:var(--silver);
}
#status{
  gap:10px;
  max-width:560px;
}
#doomWrap{
  display:flex;align-items:center;gap:6px;
  min-width:220px;
}
#doomBarOuter{
  width:120px;height:12px;
  background:var(--silver);
}
#doomBarInner{
  height:100%;
  width:0%;
  background:#b00000;
}
#quotaText{white-space:nowrap;}

/* Start menu */
#startMenu{
  position:absolute;
  left:4px;
  bottom:42px;
  width:200px;
  display:none;
  z-index:9999;
}
#startMenu .menu{
  padding:4px;
}
.menuItem{
  padding:6px 8px;
  font-size:12px;
  cursor:pointer;
}
.menuItem:hover{
  background:var(--navy);
  color:#fff;
}
.menuSep{height:1px;background:var(--gray);margin:4px 0;}

/* Layout helpers */
.split{
  display:grid;
  grid-template-columns: 160px 1fr;
  gap:6px;
  height:100%;
}
.pane{
  height:100%;
  overflow:auto;
  padding:4px;
  box-sizing:border-box;
}
.listItem{
  padding:4px 6px;
  font-size:12px;
  cursor:pointer;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.listItem:hover{background:#e8e8e8;}
.listItem.sel{background:var(--navy);color:#fff;}
.muted{color:#333;font-size:11px;}

/* Mail */
.mailListHeader{
  font-size:11px;
  padding:4px 6px;
  background:var(--silver);
  border-bottom:1px solid var(--gray);
  display:flex;justify-content:space-between;
}
.mailList{height:100%;overflow:auto;}
.mailRow{
  display:grid;
  grid-template-columns: 1fr 110px;
  gap:8px;
  padding:4px 6px;
  font-size:12px;
  border-bottom:1px solid #ddd;
  cursor:pointer;
}
.mailRow:hover{background:#f1f1f1;}
.mailRow.sel{background:var(--navy);color:#fff;}
.preview{
  height:100%;
  overflow:auto;
  padding:6px;
  box-sizing:border-box;
  font-size:12px;
}

/* Notepad */
.notepad{
  height:100%;
  background:#fff;
  color:#000;
  font-family:"Courier New", monospace;
  font-size:12px;
  padding:8px;
  box-sizing:border-box;
  overflow:auto;
  white-space:pre-wrap;
  user-select:text;
}

/* CHM */
.chm{
  height:100%;
  display:grid;
  grid-template-columns: 170px 1fr;
  gap:6px;
}
.chmList{height:100%;overflow:auto;}
.chmBody{
  height:100%;
  overflow:auto;
  padding:8px;
  box-sizing:border-box;
  background:#fff;
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
  font-size:12px;
  user-select:text;
}
.chmBody h3{margin:0 0 6px 0;font-size:14px;}
.chmBody .pun{margin-top:10px;padding:6px;background:#ffecec;border:1px solid #c00;}

/* VB form */
.formRow{display:flex;gap:10px;align-items:center;margin:8px 0;}
.group{padding:8px;}
.radioList{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:6px;}
label{font-size:12px;}
.hint{font-size:11px;color:#333;margin-top:6px;}

/* Calc */
.calc{
  height:100%;
  display:grid;
  grid-template-rows: 42px 1fr;
  gap:6px;
}
.calcDisplay{
  background:#fff;
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
  padding:8px;
  font-family:"Courier New", monospace;
  font-size:18px;
  text-align:right;
  overflow:hidden;
}
.calcKeys{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:6px;
}
.calcKeys .btn98{height:34px;}

/* SinPics */
.sxp{
  height:100%;
  display:grid;
  grid-template-rows: 1fr 40px;
  gap:6px;
}
.sxpView{
  background:#000;
  color:#b00000;
  display:flex;align-items:center;justify-content:center;
  font-family:"Courier New", monospace;
  font-size:14px;
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
  text-align:center;
  padding:10px;
  box-sizing:border-box;
  position:relative;
}
.sxpBar{
  display:flex;align-items:center;justify-content:space-between;gap:6px;
  padding:6px;box-sizing:border-box;background:var(--silver);
}
.caption{
  font-size:12px;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
  flex:1;
  padding:4px 6px;
  background:#fff;
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
}
#picsImg{
  max-width:100%;
  max-height:100%;
  display:none;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}
#picsFallback{
  display:flex;
  align-items:center;
  justify-content:center;
  width:100%;
  height:100%;
}

/* Explorer */
.explorer{
  height:100%;
  display:grid;
  grid-template-columns: 160px 1fr;
  gap:6px;
}
.tree{
  height:100%;
  overflow:auto;
  padding:6px;
  box-sizing:border-box;
  background:#fff;
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
}
.files{
  height:100%;
  overflow:auto;
  padding:6px;
  box-sizing:border-box;
  background:#fff;
  border-top:2px solid var(--black);
  border-left:2px solid var(--black);
  border-right:2px solid var(--white);
  border-bottom:2px solid var(--white);
  display:grid;
  grid-template-columns:repeat(3, minmax(120px, 1fr));
  gap:8px;
  align-content:start;
}
.fileIcon{
  display:flex;gap:8px;align-items:center;
  padding:6px;
  border:1px solid transparent;
  cursor:pointer;
}
.fileIcon:hover{border:1px dotted #000;background:#f3f3f3;}
.fileIcon .box{
  width:28px;height:24px;background:var(--silver);
  border-top:2px solid var(--white);
  border-left:2px solid var(--white);
  border-right:2px solid var(--black);
  border-bottom:2px solid var(--black);
  display:flex;align-items:center;justify-content:center;
  font-family:"Courier New", monospace;font-size:10px;color:#000;
}

/* Overlays */
#overlay{
  position:absolute;inset:0;
  display:none;
  z-index:100000;
}
#bsod{
  position:absolute;inset:0;
  background:#0000aa;
  color:#fff;
  font-family:"Courier New", monospace;
  padding:28px;
  box-sizing:border-box;
}
#bsod h1{font-size:18px;margin:0 0 16px 0;}
#bsod p{font-size:14px;line-height:1.35;margin:10px 0;}
#bsod .code{
  margin-top:18px;
  padding:10px;
  border:1px solid #fff;
  display:inline-block;
  max-width:900px;
}

/* Toast */
#toast{
  position:absolute;
  left:50%;
  top:14px;
  transform:translateX(-50%);
  display:none;
  z-index:99999;
}
#toast .bevel-out{padding:6px 10px;font-size:12px;}
